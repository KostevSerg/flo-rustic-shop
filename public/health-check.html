<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Check - FloRustic</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 { color: #1a1a1a; margin-bottom: 24px; font-size: 24px; }
        .check-item {
            padding: 16px;
            margin-bottom: 12px;
            border-radius: 8px;
            background: #f8f8f8;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .check-item.success { background: #d4f4dd; }
        .check-item.error { background: #fdd; }
        .status { font-weight: 600; }
        .status.ok { color: #059669; }
        .status.fail { color: #dc2626; }
        .info { color: #666; font-size: 14px; margin-top: 4px; }
        button {
            width: 100%;
            padding: 16px;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 16px;
        }
        button:hover { background: #059669; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ FloRustic</h1>
        <div id="checks"></div>
        <button onclick="location.href='/'">–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é</button>
    </div>

    <script>
        const checks = [];
        
        // 1. JavaScript —Ä–∞–±–æ—Ç–∞–µ—Ç
        checks.push({
            name: 'JavaScript',
            status: 'ok',
            info: 'JavaScript –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ'
        });
        
        // 2. LocalStorage –¥–æ—Å—Ç—É–ø–µ–Ω
        try {
            localStorage.setItem('test', '1');
            localStorage.removeItem('test');
            checks.push({
                name: 'LocalStorage',
                status: 'ok',
                info: 'LocalStorage –¥–æ—Å—Ç—É–ø–µ–Ω'
            });
        } catch (e) {
            checks.push({
                name: 'LocalStorage',
                status: 'fail',
                info: 'LocalStorage –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ' + e.message
            });
        }
        
        // 3. Fetch API –¥–æ—Å—Ç—É–ø–µ–Ω
        checks.push({
            name: 'Fetch API',
            status: typeof fetch !== 'undefined' ? 'ok' : 'fail',
            info: typeof fetch !== 'undefined' ? 'Fetch API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è' : 'Fetch API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è'
        });
        
        // 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API
        fetch('https://functions.poehali.dev/3f4d37f0-b84f-4157-83b7-55bdb568e459?action=list')
            .then(r => r.ok ? r.json() : Promise.reject(r))
            .then(data => {
                addCheck({
                    name: 'API –≥–æ—Ä–æ–¥–æ–≤',
                    status: 'ok',
                    info: `–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${Object.keys(data.cities || {}).length} —Ä–µ–≥–∏–æ–Ω–æ–≤`
                });
            })
            .catch(err => {
                addCheck({
                    name: 'API –≥–æ—Ä–æ–¥–æ–≤',
                    status: 'fail',
                    info: '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API: ' + err.message
                });
            });
        
        // 5. User Agent
        checks.push({
            name: '–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ',
            status: 'ok',
            info: navigator.userAgent.includes('Mobile') ? '–ú–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ' : '–î–µ—Å–∫—Ç–æ–ø'
        });
        
        // 6. –†–∞–∑–º–µ—Ä —ç–∫—Ä–∞–Ω–∞
        checks.push({
            name: '–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞',
            status: 'ok',
            info: `${window.innerWidth}x${window.innerHeight}px`
        });
        
        // 7. Online —Å—Ç–∞—Ç—É—Å
        checks.push({
            name: '–ò–Ω—Ç–µ—Ä–Ω–µ—Ç',
            status: navigator.onLine ? 'ok' : 'fail',
            info: navigator.onLine ? '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ' : '–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è'
        });
        
        function addCheck(check) {
            checks.push(check);
            renderChecks();
        }
        
        function renderChecks() {
            const container = document.getElementById('checks');
            container.innerHTML = checks.map(check => `
                <div class="check-item ${check.status === 'ok' ? 'success' : 'error'}">
                    <div style="flex: 1;">
                        <div>
                            <span class="status ${check.status === 'ok' ? 'ok' : 'fail'}">
                                ${check.status === 'ok' ? '‚úì' : '‚úó'}
                            </span>
                            <strong>${check.name}</strong>
                        </div>
                        <div class="info">${check.info}</div>
                    </div>
                </div>
            `).join('');
        }
        
        renderChecks();
    </script>
</body>
</html>
